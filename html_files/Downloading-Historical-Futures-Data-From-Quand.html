
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="google-site-verification" content="wl3-8ed1QZjI0iYZMv10zoZWYElkMObTfwLlWIj9cpA" />
    <meta name="description" content="Downloading Historical Futures Data From Quandl">

    <link rel="icon" href="/static/images/favicon.png">

    <title>Downloading Historical Futures Data From Quandl | QuantStart</title>
    
    
<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900&display=swap" rel="stylesheet"> 
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900&display=swap" rel="stylesheet"> 
<link href="/static/css/bootstrap.min.css" rel="stylesheet">
<link href="/static/css/prism.css" rel="stylesheet">
<link href="/static/css/qs.css?v=10" rel="stylesheet">
    
  </head>

  <body>
    <header class="header covered-header" style="background-image: linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8)), url(https://quantstartmedia.s3.amazonaws.com/images/article-images/article-backgrounds/default-bg.jpg);">
  
<nav class="nav">
  <div class="container nav-container">
    <div class="nav-row row d-flex justify-content-between align-items-center">
      <div class="col-2">
        <ul class="nav-items justify-content-end small-capitals align-items-center">
          <li class="nav-item">
            <a class="link-fade" href="/">QuantStart</a>
          </li>
        </ul>
      </div>
      <div class="col-auto col-logo">
        <ul id="top-nav-menu" class="nav-items justify-content-end align-items-center">
          
          <li class="nav-item">
            <a class="link-fade" href="/qsalpha/">QSAlpha</a>
          </li>
          
          
          <li class="nav-item">
            <a class="link-fade" href="/quantcademy/">Quantcademy</a>
          </li>
          
          <li id="menu-link-ebooks" class="nav-item">
            <a class="link-fade" href="#">Books</a>
            <div id="menu-pane-ebooks" class="nav-items menu-dropdown-pane">
              <div class="nav-item">
                <a class="link-fade d-block ml-3 mr-3 my-3 mt-4" href="/successful-algorithmic-trading-ebook/">Successful Algorithmic Trading</a>
              </div>
              <div class="nav-item">
                <a class="link-fade d-block ml-3 mr-3 my-3 mt-4" href="/advanced-algorithmic-trading-ebook/">Advanced Algorithmic Trading</a>
              </div>
              <div class="nav-item">
                <a class="link-fade d-block ml-3 mr-3 my-3 mt-4" href="/cpp-for-quantitative-finance-ebook/">C++ For Quantitative Finance</a>
              </div>
            </div>
          </li>
          <li class="nav-item">
            <a class="link-fade" href="/qstrader/">QSTrader</a>
          </li>
          <li class="nav-item">
            <a class="link-fade" href="/articles/">Articles</a>
          </li>
          
          <li class="nav-item">
            <a class="link-fade" href="/members/login/">Login</a>
          </li>
          
        </ul>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>
    </div>
  </div>
</nav>

<nav id="mobile-nav" class="mobile-nav text-left">
  <div class="container">
    <ul class="mt-4 ml-3 mobile-nav-menu">
      <li class="nav-item">
        <a class="link-fade d-block" href="/">QuantStart</a>
      </li>

      
      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/qsalpha/">QSAlpha</a>
      </li>
      

      
      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/quantcademy/">Quantcademy</a>
      </li>
      

      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="#">Books</a>
      </li>
      <li class="nav-item sub-item">
        <a class="link-fade d-block ml-3" href="/successful-algorithmic-trading-ebook/">Successful Algorithmic Trading</a>
      </li>
      <li class="nav-item sub-item">
        <a class="link-fade d-block ml-3" href="/advanced-algorithmic-trading-ebook/">Advanced Algorithmic Trading</a>
      </li>
      <li class="nav-item sub-item">
        <a class="link-fade d-block ml-3" href="/cpp-for-quantitative-finance-ebook/">C++ For Quantitative Finance</a>
      </li>

      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/qstrader/">QSTrader</a>
      </li>

      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/articles/">Articles</a>
      </li>

      
      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/members/login/">Login</a>
      </li>
      
    </ul>
    <button class="nav-toggle mobile-nav-close">
      <svg id="mobile-nav-close-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M19.77,5.63,13.41,12l6.36,6.37a1,1,0,0,1-1.41,1.41L12,13.41,5.63,19.77a1,1,0,0,1-1.44-1.39l0,0L10.58,12,4.21,5.63a1,1,0,0,1,0-1.42,1,1,0,0,1,1.41,0l0,0L12,10.58l6.37-6.37a1,1,0,0,1,1.41,0A1,1,0,0,1,19.77,5.63Z"></path>
      </svg>
    </button>
  </div>
</nav>

  <div class="container hero-container">
    <section class="mt-5 mb-4">
      <div class="row justify-content-center">
        <div class="col-12 text-center">
          <p class="hero">Downloading Historical Futures Data From Quandl</p>
          <p class="hero subhero">Downloading Historical Futures Data From Quandl</p>
        </div>
      </div>
    </section>
  </div>
</header>
    
<section class="container content-container">
  <div class="row">
    <div class="col-md-8 order-md-2">
      <section class="content article-content">
        
        
        <p>Futures contracts are ubiquitous in quantitative trading and have yet to be discussed in any great detail on QuantStart. This will be the first in a series of articles explaining how to download, store, clean and stitch futures data for use in your trading systems.</p>

<p>Up until recently it was rather difficult and expensive to obtain consistent futures data across exchanges in frequently updated manner. That has all changed recently with the release of <a href="http://www.quandl.com/">Quandl</a>. It's a fantastic source of free financial data. They have a <a href="http://www.quandl.com/futures">substantial library of daily futures prices</a> in some cases going back to the 1950s!</p>

<p>Not only is the service a robust library of data but their <a href="http://www.quandl.com/help/api">API</a> allows export in CSV, HTML, JSON and XML. In addition there are bindings for Python, R, Excel, MatLab, Stata, C++, Java and many other languages/packages. Without understatement this has made obtaining a wide range of daily financial data incredibly straightforward. In this article we are going to make use of Python (predominantly NumPy and pandas) to obtain futures data from Quandl and store it to disk.</p>

<p>In order to get the most out of this tutorial you will need to have pandas successfully installed. In addition you may want to utilise an interactive development environment like Canopy or the IPython console. I've written a <a href="http://www.quantstart.com/articles/Installing-a-Desktop-Algorithmic-Trading-Research-Environment-using-Ubuntu-Linux-and-Python">tutorial/video on how to go about this</a> from scratch.</p>

<p><em>Disclaimer: I have not been approached by Quandl in regard to writing this article. I am just a big fan of what they're trying to achieve and want to let you all know how useful their service is. Plus, it's completely free and works out-of-the-box with nearly any major programming language out there. What's not to like?</em></p>

<h2>Signing Up For Quandl</h2>

<p>The first thing we are going to do is sign up to Quandl so that we can increase our daily allowance of calls to their API. Sign-up grants you 500 calls per day, rather than the default 50. Let's begin by visiting the site at <a href="http://www.quandl.com">www.quandl.com</a>:</p>

<p class="bordered-image">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-quandl-futures-0001.png"><br>
  <strong>The Quandl homepage</strong>
</p>

<p>Click on the sign-up button on the top right:</p>

<p class="bordered-image">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-quandl-futures-0002.png"><br>
  <strong>The Quandl sign-up page</strong>
</p>

<p>Once you're signed in you'll be returned to the home page:</p>

<p class="bordered-image">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-quandl-futures-0003.png"><br>
  <strong>The Quandl authorised home page</strong>
</p>

<h2>Quandl Futures Data</h2>

<p>Now click on the <a href="http://www.quandl.com/futures">"New: Futures page..."</a> link to get to the futures homepage:</p>

<p class="bordered-image">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-quandl-futures-0004.png"><br>
  <strong>The Quandl futures contracts home page</strong>
</p>

<p>For this tutorial we're interested in one of the most liquid financial instruments available, the E-Mini S&amp;P500 futures contract, which has the futures symbol ES.</p>

<p>If you want to download any of the other contracts instead then you can obviously replace the remainder of the tutorial with your chosen symbol and everything should "just work"!</p>

<p>Click on the <a href="http://www.quandl.com/futures/e-mini-s-and-p-500-index-futures">E-Mini S&amp;P500 link</a> (or your chosen futures symbol) and you'll be taken to the following screen:</p>

<p class="bordered-image">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-quandl-futures-0005.png"><br>
  <strong>E-Mini S&amp;P500 contract page</strong>
</p>

<p>If you scroll down you'll see the list of historical contracts going back to 1997:</p>

<p class="bordered-image">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-quandl-futures-0006.png"><br>
  <strong>E-Mini S&amp;P500 historical contracts</strong>
</p>

<p>We can now click on one of the individual contracts. I've picked ESZ2014, which refers to the contract for December 2014 'delivery'. You'll see a handy chart of the data:</p>

<p class="bordered-image">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-quandl-futures-0007.png"><br>
  <strong>Chart of ESZ2014 (December 2014 delivery)</strong>
</p>

<p>By clicking on the "Download" button the data can be obtained in multiple formats: HTML, CSV, JSON or XML. In addition we can download the data directly into a pandas DataFrame using the Python bindings. While the latter is useful for quick "prototyping" and exploration of the data, we're more interested in building a longer term data store. We're especially interested in creating continuous time series of futures contracts (which will be the subject of the next article). Go ahead and click the download button, select "CSV" and then copy &amp; paste the API call:</p>

<p class="bordered-image">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-quandl-futures-0008.png"><br>
  <strong>Download modal for ESZ2014 CSV file</strong>
</p>

<p>The API call will look something like this: 

<p><code>http://www.quandl.com/api/v1/datasets/OFDP/FUTURE_ESZ2014.csv?&auth_token={{MY_AUTH_TOKEN}}&trim_start=2013-09-18&trim_end=2013-12-04&sort_order=desc</code></p>

<p>Where I've redacted my authorisation token and replaced it with <code>{{MY_AUTH_TOKEN}}</code>. You will need to copy the alphanumeric string between "auth_token=" and "&trim_start" for later usage in the Python script below. Do not share it with anyone as it is your unique authorisation token for Quandl downloads and is used to determine your download rate for the day.</p>

<p>This API call will form the basis of an automated script which we will write below to download a subset of the entire historical futures contract.</p>

<h2>Downloading Quandl Futures into Python</h2>

<p>Because we are interested in using the futures data long-term as part of a wider securities master database strategy we want to store the futures data to disk. Thus we need to create a directory to hold our E-Mini contract CSV files. In Mac/Linux (within the terminal/console) this is achieved by the following command:</p>

<pre>
<code class="language-bash">cd ~
mkdir -p quandl/futures/ES</code>
</pre>

<p><em>Note: You can obviously choose a different directory structure for your data needs, but I've gone with a simple approach of putting it underneath the Linux/Mac "home" directory.</em></p>

<p>This creates a subdirectory of your home directory called <code>quandl</code>, which contains two further subdirectories for <code>futures</code> and for the <code>ES</code> contracts in particular. This will help us to organise our downloads in an ongoing fashion.</p>

<p>In order to carry out the download using Python we will need to import some libraries. In particular we will need <a href="http://docs.python.org/2/library/urllib2.html">urllib2</a> for the download and <a href="http://pandas.pydata.org/">pandas</a> for plotting/manipulation. If you haven't installed pandas before, then please follow my tutorial on <a href="http://www.quantstart.com/articles/Installing-a-Desktop-Algorithmic-Trading-Research-Environment-using-Ubuntu-Linux-and-Python">installing an algorithmic trading research environment in Linux</a> first. Let's begin our Python script by importing the two libraries:</p>

<pre>
<code class="language-python">import pandas as pd
import urllib2</code>
</pre>

<p>The first function within the code will generate the list of futures symbols we wish to download. I've added keyword parameters for the start and end years, setting them to reasonable values of 2010 and 2014. You can, of course, choose to use other timeframes:</p>

<pre>
<code class="language-python">def construct_futures_symbols(symbol, start_year=2010, end_year=2014):
    """Constructs a list of futures contract codes for a 
    particular symbol and timeframe."""
    futures = []
    months = 'HMUZ'  # March, June, September and December delivery codes
    for y in range(start_year, end_year+1):
        for m in months:
            futures.append("%s%s%s" % (symbol, m, y))
    return futures</code>
</pre>

<p>Now we need to loop through each symbol, obtain the CSV file from Quandl for that particular contract and subsequently write it to disk so we can access it later:</p>

<pre>
<code class="language-python">def download_contract_from_quandl(contract, auth_token, dl_dir):
    """Download an individual futures contract from Quandl and then
    store it to disk in the 'dl_dir' directory. An auth_token is 
    required, which is obtained from the Quandl upon sign-up."""

    # Construct the API call from the contract and auth_token    
    api_call_head = "http://www.quandl.com/api/v1/datasets/OFDP/FUTURE_%s.csv" % contract
    params = "?&auth_token=%s&sort_order=asc" % auth_token
    
    # Download the data from Quandl
    data = urllib2.urlopen("%s%s" % (api_call_head, params)).read()
    
    # Store the data to disk
    fc = open('%s/%s.csv' % (dl_dir, contract), 'w')
    fc.write(data)
    fc.close()</code>
</pre>

<p>Now we tie the above two functions together to download all of the desired contracts:</p>

<pre>
<code class="language-python">def download_historical_contracts(symbol, auth_token, dl_dir, start_year=2010, end_year=2014):
    """Downloads all futures contracts for a specified symbol
    between a start_year and an end_year."""
    contracts = construct_futures_symbols(symbol, start_year, end_year)
    for c in contracts:
        download_contract_from_quandl(c, auth_token, dl_dir)</code>
</pre>

<p>Finally, we can add one of the futures prices to a pandas dataframe using the <code>main</code> function:</p>

<pre>
<code class="language-python">if __name__ == "__main__":
    symbol = 'ES'
    dl_dir = 'quandl/futures/ES'  # Make sure you've created this relative directory beforehand
    auth_token = 'YOUR_AUTH_TOKEN'  # Replace this with your authorisation token
    start_year = 2010
    end_year = 2014

    # Download the contracts into the directory
    download_historical_contracts(symbol, auth_token, dl_dir, start_year, end_year)

    # Open up a single contract via read_csv and plot the closing price
    es = pd.io.parsers.read_csv("%s/ESZ2014.csv" % dl_dir)</code>
</pre>

<p>If we were running this script in IPython or Canopy then we could simply plot the settle (close price) data inline:</p>

<pre>
<code class="language-bash">plot(es['Settle'])</code>
</pre>

<p>Here is the output from Canopy/IPython:</p>

<p class="bordered-image">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-quandl-futures-0009.png"><br>
  <strong>ESZ2014 Settle/Close price chart from Canopy/IPython</strong>
</p>

<p>You can use this code to collect any combination of futures contracts from Quandl as you see fit. Remember though that unless you request a higher API rate limit, you'll be stuck with 500 requests per day (or 50 if you don't sign up).</p>

<p>In the next article we will go into an in-depth discussion of creating a continuous futures contract from a set of individual contracts for separate delivery dates. This will be necessary to carry out statistical analysis and backtesting research over long-time frames.</p>

<p><em><strong>Edit:</strong> Andy E. pointed out that I had a mistake in the</em> <code>download_contract_from_quandl(c, auth_token, dl_dir)</code><em> line above. I've corrected it now.</em></p>
        
        
        <script async data-uid="6296c27f4b" src="https://weathered-brook-5281.ck.page/6296c27f4b/index.js"></script>
      </section>
    </div>
    <div class="col-md-4 book-card order-md-1">
      
<div class="sidebar-advert-container">
  <a href="/qsalpha/?ref=art">
    <img class="card-img-top" src="/static/images/qsalpha-sidebar-advert-small.png" alt="QSAlpha">
  </a>
  <div class="card mb-4 box-shadow">
    <div class="card-body text-center">
      <h3 class="mb-3"><a class="link-fade" href="/qsalpha/?ref=art">QSAlpha</a></h3>
      <p class="card-text medium-text mb-3">Join the QSAlpha research platform that helps fill your strategy research pipeline, diversifies your portfolio and improves your risk-adjusted returns for increased profitability.</p>
      <div class="d-flex justify-content-center align-items-center">
        <div class="btn-group">
          <a class="btn btn-padded btn-outline-primary btn-lg-cta" href="/qsalpha/?ref=art">Find Out More</a>
        </div>
      </div>
    </div>
  </div>

  <a href="/quantcademy/?ref=art">
    <img class="card-img-top" src="/static/images/quantcademy-sidebar-advert-small.png" alt="Quantcademy">
  </a>
  <div class="card mb-4 box-shadow">
    <div class="card-body text-center">
      <h3 class="mb-3"><a class="link-fade" href="/quantcademy/?ref=art">The Quantcademy</a></h3>
      <p class="card-text medium-text mb-3">Join the Quantcademy membership portal that caters to the rapidly-growing retail quant trader community and learn how to increase your strategy profitability.</p>
      <div class="d-flex justify-content-center align-items-center">
        <div class="btn-group">
          <a class="btn btn-padded btn-outline-primary btn-lg-cta" href="/quantcademy/?ref=art">Find Out More</a>
        </div>
      </div>
    </div>
  </div>

  <a href="/successful-algorithmic-trading-ebook/">
    <img class="card-img-top" src="/static/images/sat-sidebar-advert-small.png" alt="Successful Algorithmic Trading">
  </a>
  <div class="card mb-4 box-shadow">
    <div class="card-body text-center">
      <h3 class="mb-3"><a class="link-fade" href="/successful-algorithmic-trading-ebook/">Successful Algorithmic Trading</a></h3>
      <p class="card-text medium-text mb-3">How to find new trading strategy ideas and objectively assess them for your portfolio using a Python-based backtesting engine.</p>
      <div class="d-flex justify-content-center align-items-center">
        <div class="btn-group">
          <a class="btn btn-padded btn-outline-primary btn-lg-cta" href="/successful-algorithmic-trading-ebook/">Find Out More</a>
        </div>
      </div>
    </div>
  </div>

  <a href="/advanced-algorithmic-trading-ebook/">
    <img class="card-img-top" src="/static/images/aat-sidebar-advert-small.png" alt="Advanced Algorithmic Trading">
  </a>
  <div class="card mb-4 box-shadow">
    <div class="card-body text-center">
      <h3 class="mb-3"><a class="link-fade" href="/advanced-algorithmic-trading-ebook/">Advanced Algorithmic Trading</a></h3>
      <p class="card-text medium-text mb-3">How to implement advanced trading strategies using time series analysis, machine learning and Bayesian statistics with R and Python.</p>
      <div class="d-flex justify-content-center align-items-center">
        <div class="btn-group">
          <a class="btn btn-padded btn-outline-primary btn-lg-cta" href="/advanced-algorithmic-trading-ebook/">Find Out More</a>
        </div>
      </div>
    </div>
  </div>
</div>
    </div>
  </div>
</section>

    

<footer>
  <div class="container container-full">
    <section class="mt-1.5 mb-1">
      <div class="row">
        <div class="col-12 col-sm-12 col-md-6 col-xl-3 mb-1.5">
          <ul class="footer-list">
            <li class="footer-list-title">QuantStart</li>
            <li class="footer-list-link"><a class="link-fade" href="/about/">About</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/articles/">Articles</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/sitemap/">Sitemap</a></li>
          </ul>
        </div>

        <div class="col-12 col-sm-12 col-md-6 col-xl-3 mb-1.5">
          <ul class="footer-list">
            <li class="footer-list-title">Products</li>
            
            <li class="footer-list-link"><a class="link-fade" href="/qsalpha/">QSAlpha</a></li>
            
            
            <li class="footer-list-link"><a class="link-fade" href="/quantcademy/">Quantcademy</a></li>
            
            <li class="footer-list-link"><a class="link-fade" href="/qstrader/">QSTrader</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/successful-algorithmic-trading-ebook/">Successful Algorithmic Trading</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/advanced-algorithmic-trading-ebook/">Advanced Algorithmic Trading</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/cpp-for-quantitative-finance-ebook/">C++ For Quantitative Finance</a></li>
          </ul>
        </div>

        <div class="col-12 col-sm-12 col-md-6 col-xl-3 mb-1.5">
          <ul class="footer-list">
            <li class="footer-list-title">Legal</li>
            <li class="footer-list-link"><a class="link-fade" href="/privacy-policy/">Privacy Policy</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/terms-and-conditions/">Terms &amp; Conditions</a></li>
          </ul>
        </div>

        <div class="col-12 col-sm-12 col-md-6 col-xl-3 mb-1.5">
          <ul class="footer-list">
            <li class="footer-list-title">Social</li>
            <li class="footer-list-link"><a class="link-fade" href="https://twitter.com/quantstart">Twitter</a></li>
            <li class="footer-list-link"><a class="link-fade" href="https://www.youtube.com/channel/UCmVnnZ6Y2TrJtY1eQJN6kWA">YouTube</a></li>
          </ul>
        </div>
      </div>
    </section>

    <div class="row mb-1.5 mt-5">
      <div class="col-12 col-md-9 col-lg-8 col-xl-6">
        <div class="footer-copyright">
          <p>©2012-2023 QuarkGluon Ltd. All rights reserved.</p>
        </div>
      </div>
    </div>
  </div>
</footer>

    
<script src="/static/js/jquery-3.2.1.min.js"></script>
<script src="/static/js/prism.js.min"></script>
<script src="/static/js/bootstrap.min.js"></script>
<script src="/static/js/nav.js"></script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-5383959-5']);
  _gaq.push(['_trackPageview']);

  (function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


    
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="/static/js/highcharts/highcharts.js"></script>
<script type="text/javascript">
  num_colours = 10;
</script>
<script src="/static/js/statistics.js"></script>


  </body>
</html>
