
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="google-site-verification" content="wl3-8ed1QZjI0iYZMv10zoZWYElkMObTfwLlWIj9cpA" />
    <meta name="description" content="Derivative Approximation via Finite Difference Methods">

    <link rel="icon" href="/static/images/favicon.png">

    <title>Derivative Approximation via Finite Difference Methods | QuantStart</title>
    
    
<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900&display=swap" rel="stylesheet"> 
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900&display=swap" rel="stylesheet"> 
<link href="/static/css/bootstrap.min.css" rel="stylesheet">
<link href="/static/css/prism.css" rel="stylesheet">
<link href="/static/css/qs.css?v=10" rel="stylesheet">
    
  </head>

  <body>
    <header class="header covered-header" style="background-image: linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8)), url(https://quantstartmedia.s3.amazonaws.com/images/article-images/article-backgrounds/derivatives-pricing.jpg);">
  
<nav class="nav">
  <div class="container nav-container">
    <div class="nav-row row d-flex justify-content-between align-items-center">
      <div class="col-2">
        <ul class="nav-items justify-content-end small-capitals align-items-center">
          <li class="nav-item">
            <a class="link-fade" href="/">QuantStart</a>
          </li>
        </ul>
      </div>
      <div class="col-auto col-logo">
        <ul id="top-nav-menu" class="nav-items justify-content-end align-items-center">
          
          <li class="nav-item">
            <a class="link-fade" href="/qsalpha/">QSAlpha</a>
          </li>
          
          
          <li class="nav-item">
            <a class="link-fade" href="/quantcademy/">Quantcademy</a>
          </li>
          
          <li id="menu-link-ebooks" class="nav-item">
            <a class="link-fade" href="#">Books</a>
            <div id="menu-pane-ebooks" class="nav-items menu-dropdown-pane">
              <div class="nav-item">
                <a class="link-fade d-block ml-3 mr-3 my-3 mt-4" href="/successful-algorithmic-trading-ebook/">Successful Algorithmic Trading</a>
              </div>
              <div class="nav-item">
                <a class="link-fade d-block ml-3 mr-3 my-3 mt-4" href="/advanced-algorithmic-trading-ebook/">Advanced Algorithmic Trading</a>
              </div>
              <div class="nav-item">
                <a class="link-fade d-block ml-3 mr-3 my-3 mt-4" href="/cpp-for-quantitative-finance-ebook/">C++ For Quantitative Finance</a>
              </div>
            </div>
          </li>
          <li class="nav-item">
            <a class="link-fade" href="/qstrader/">QSTrader</a>
          </li>
          <li class="nav-item">
            <a class="link-fade" href="/articles/">Articles</a>
          </li>
          
          <li class="nav-item">
            <a class="link-fade" href="/members/login/">Login</a>
          </li>
          
        </ul>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>
    </div>
  </div>
</nav>

<nav id="mobile-nav" class="mobile-nav text-left">
  <div class="container">
    <ul class="mt-4 ml-3 mobile-nav-menu">
      <li class="nav-item">
        <a class="link-fade d-block" href="/">QuantStart</a>
      </li>

      
      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/qsalpha/">QSAlpha</a>
      </li>
      

      
      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/quantcademy/">Quantcademy</a>
      </li>
      

      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="#">Books</a>
      </li>
      <li class="nav-item sub-item">
        <a class="link-fade d-block ml-3" href="/successful-algorithmic-trading-ebook/">Successful Algorithmic Trading</a>
      </li>
      <li class="nav-item sub-item">
        <a class="link-fade d-block ml-3" href="/advanced-algorithmic-trading-ebook/">Advanced Algorithmic Trading</a>
      </li>
      <li class="nav-item sub-item">
        <a class="link-fade d-block ml-3" href="/cpp-for-quantitative-finance-ebook/">C++ For Quantitative Finance</a>
      </li>

      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/qstrader/">QSTrader</a>
      </li>

      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/articles/">Articles</a>
      </li>

      
      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/members/login/">Login</a>
      </li>
      
    </ul>
    <button class="nav-toggle mobile-nav-close">
      <svg id="mobile-nav-close-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M19.77,5.63,13.41,12l6.36,6.37a1,1,0,0,1-1.41,1.41L12,13.41,5.63,19.77a1,1,0,0,1-1.44-1.39l0,0L10.58,12,4.21,5.63a1,1,0,0,1,0-1.42,1,1,0,0,1,1.41,0l0,0L12,10.58l6.37-6.37a1,1,0,0,1,1.41,0A1,1,0,0,1,19.77,5.63Z"></path>
      </svg>
    </button>
  </div>
</nav>

  <div class="container hero-container">
    <section class="mt-5 mb-4">
      <div class="row justify-content-center">
        <div class="col-12 text-center">
          <p class="hero">Derivative Approximation via Finite Difference Methods</p>
          <p class="hero subhero">Derivative Approximation via Finite Difference Methods</p>
        </div>
      </div>
    </section>
  </div>
</header>
    
<section class="container content-container">
  <div class="row">
    <div class="col-md-8 order-md-2">
      <section class="content article-content">
        
        
        <div class="alert alert-info">
  <p>This post is part of a series of <strong>Finite Difference Method Articles</strong>. Other posts in the series concentrate on Solving The Heat/Diffusion Equation Explicitly, the Crank-Nicolson Implicit Method and the Tridiagonal Matrix Solver/Thomas Algorithm:</p>
  <ul>
    <li><em>Derivative Approximation via Finite Difference Methods</em></li>
    <li><a href="/articles/Solving-the-Diffusion-Equation-Explicitly">Solving the Diffusion Equation Explicitly</a></li>
    <li><a href="/articles/Crank-Nicholson-Implicit-Scheme">Crank-Nicolson Implicit Scheme</a></li>
    <li><a href="/articles/Tridiagonal-Matrix-Solver-via-Thomas-Algorithm">Tridiagonal Matrix Solver via Thomas Algorithm</a></li>
  </ul>
</div>

<p>This is the first in a multi-part tutorial series on using Finite Difference Methods (FDM) to numerically solve parabolic partial differential equations. In particular, the heat equation will be solved. Given that the Black-Scholes pricing equation can be transformed into a heat equation, these methods can be applied to solve the equation numerically.</p>

<p>If we let \(f \in C^2(\mathbb{R})\), i.e. let f be a continuous function of the real numbers which is twice differentiable, then the heat equation for \(f\) is given by:</p>

<p>\[ \frac{\partial f}{\partial t} = \frac{\partial^2 f}{\partial x^2} \]</p>

<h3>Discretising Derivatives</h3>

<p>The Finite Difference Method provides a numerical solution to this equation via the discretisation of its derivatives. The derivatives will be approximated via a Taylor Series expansion. Recall that a Taylor Series provides a value for a function \(f=f(x)\) when the dependent variable \(x \in \mathbb{R}\) is translated by an amount \(\Delta x\), in terms of its derivatives at that point. Thus, \(f(x+\Delta x)\) can be calculated by:</p>

<p>\[ f(x+\Delta x) = f(x) + f'(x)\Delta x + \frac{f''(x)(\Delta x)^2}{2!} + \frac{f'''(x)(\Delta x)^3}{3!} + O(\Delta x)^4 \]</p>

<p>Note that \(O(\Delta x)\) represents additional terms that are bounded by a constant term multipled by \(\Delta x\).</p>

<p>In a similar manner, we can determine \(f\) when the dependent variable \(x\) is translated by an identical amount \(\Delta x\) in the opposite direction:</p>

<p>\[ f(x-\Delta x) = f(x) - f'(x)\Delta x + \frac{f''(x)(\Delta x)^2}{2!} - \frac{f'''(x)(\Delta x)^3}{3!} + O(\Delta x)^4 \]</p>

<p>These two equations when rearranged allow a <em>first order approximation</em> for the derivative \(f'(x)\):</p>

<p>\[ \begin{aligned}<br /> 
f'(x) &#038; = \frac{f(x+\Delta x)-f(x)}{\Delta x} + O(\Delta x) \\<br />
      &#038; = \frac{f(x)-f(x-\Delta x)}{\Delta x} + O(\Delta x) \\<br />
\end{aligned}<br /> \] </p>

<p>In addition, subtracting the backward Taylor expansion from the forward Taylor expansion provides a <em>second order approximation</em> for the derivative \(f'(x)\):</p>

<p>\[ f'(x) = \frac{f(x+\Delta x)-f(x-\Delta x)}{2 \Delta x} + O(\Delta x)^2 \]</p>

<p>To obtain a second order approximation for the second derivative of \(f\), \(f''(x)\), we can add the forward and backward Taylor expansions to receive:</p>

<p>\[ f''(x) = \frac{f(x+\Delta x)-2f(x)+f(x-\Delta x)}{(\Delta x)^2} + O(\Delta x)^2 \]</p>

<h3>Domain Discretisation</h3>

<p>Now that the derivatives have been approximated in a one-dimensional continuous setting, it is time to discretise the domain of the heat equation. The function \(f\) is now a function of two real variables \(x\) and \(t\) which represent space and time, respectively. The function \(f=f(x,t)\) can be thought of as the quantity of heat at any point along a one-dimensional bar.</p>

<p>The 1D continuous bar can be discretised into \(I\) separate points \(1,2,...,i,...,I\). Time can be discretised into \(N\) separate points \(1,2,...,n,...,N\), each separated by a time-spacing \(\Delta t\). The approximation \(f^n_i\) to \(f\) at time \(n\) and location \(x=i\Delta x\) is given by:</p>

<p>\[ f^n_i \approx f(i\Delta x, n\Delta t) \]</p>

<p>Note that the superscript \(n\) does not refer to a power of \(f\) or its \(n\)th derivative, instead it refers to its value at the time \(n \Delta t\). Thus, the aforementioned Taylor approximations to the derivatives can be written as:</p>

<p>\[ \begin{aligned}<br />
f'(i\Delta x, n\Delta t) &#038; \approx \frac{f^n_{i+1} - f^n_i}{\Delta x} \\<br />
&#038; \approx \frac{f^n_i - f^n_{i-1}}{\Delta x} \\<br />
&#038; \approx \frac{f^n_{i+1} - f^n_{i-1}}{2\Delta x} \\<br />
f''(i\Delta x, n\Delta t) &#038; \approx \frac{f^n_{i+1} - 2 f^n_i + f^n_{i-1}}{(\Delta x)^2} \\<br />
\end{aligned}<br /> \]</p>

<p>They are, respectively, the <em>forward difference</em>, <em>backward difference</em>, <em>centered difference</em> and <em>centered second difference</em>.</p>

<h3>Errors and Conclusion</h3>

<p>Given that the differences are approximations it is natural to question how errors can arise in the overall solution. In fact, two types of errors can occur. They are the <em>truncation error</em> and the <em>roundoff error</em>. Truncation error is the error associated with the discretisation of the derivatives, i.e. those occuring due to the additional higher order derivative terms.</p>

<p>Roundoff error is that which occurs due to the precision of the solution being stored on a computer. Usually <em>double precision</em> floating point values are used which store 16 digits for each value. These errors can accumulate, particularly if <em>single precision</em> is used, which only stores 8 digits for floating point values.</p>

<p>In the next tutorial the heat equation will be solved numerically. It will be seen how truncation error can rapidly accumulate if certain conditions are not enforced.</p>
        
        
        <script async data-uid="6296c27f4b" src="https://weathered-brook-5281.ck.page/6296c27f4b/index.js"></script>
      </section>
    </div>
    <div class="col-md-4 book-card order-md-1">
      
<div class="sidebar-advert-container">
  <a href="/qsalpha/?ref=art">
    <img class="card-img-top" src="/static/images/qsalpha-sidebar-advert-small.png" alt="QSAlpha">
  </a>
  <div class="card mb-4 box-shadow">
    <div class="card-body text-center">
      <h3 class="mb-3"><a class="link-fade" href="/qsalpha/?ref=art">QSAlpha</a></h3>
      <p class="card-text medium-text mb-3">Join the QSAlpha research platform that helps fill your strategy research pipeline, diversifies your portfolio and improves your risk-adjusted returns for increased profitability.</p>
      <div class="d-flex justify-content-center align-items-center">
        <div class="btn-group">
          <a class="btn btn-padded btn-outline-primary btn-lg-cta" href="/qsalpha/?ref=art">Find Out More</a>
        </div>
      </div>
    </div>
  </div>

  <a href="/quantcademy/?ref=art">
    <img class="card-img-top" src="/static/images/quantcademy-sidebar-advert-small.png" alt="Quantcademy">
  </a>
  <div class="card mb-4 box-shadow">
    <div class="card-body text-center">
      <h3 class="mb-3"><a class="link-fade" href="/quantcademy/?ref=art">The Quantcademy</a></h3>
      <p class="card-text medium-text mb-3">Join the Quantcademy membership portal that caters to the rapidly-growing retail quant trader community and learn how to increase your strategy profitability.</p>
      <div class="d-flex justify-content-center align-items-center">
        <div class="btn-group">
          <a class="btn btn-padded btn-outline-primary btn-lg-cta" href="/quantcademy/?ref=art">Find Out More</a>
        </div>
      </div>
    </div>
  </div>

  <a href="/successful-algorithmic-trading-ebook/">
    <img class="card-img-top" src="/static/images/sat-sidebar-advert-small.png" alt="Successful Algorithmic Trading">
  </a>
  <div class="card mb-4 box-shadow">
    <div class="card-body text-center">
      <h3 class="mb-3"><a class="link-fade" href="/successful-algorithmic-trading-ebook/">Successful Algorithmic Trading</a></h3>
      <p class="card-text medium-text mb-3">How to find new trading strategy ideas and objectively assess them for your portfolio using a Python-based backtesting engine.</p>
      <div class="d-flex justify-content-center align-items-center">
        <div class="btn-group">
          <a class="btn btn-padded btn-outline-primary btn-lg-cta" href="/successful-algorithmic-trading-ebook/">Find Out More</a>
        </div>
      </div>
    </div>
  </div>

  <a href="/advanced-algorithmic-trading-ebook/">
    <img class="card-img-top" src="/static/images/aat-sidebar-advert-small.png" alt="Advanced Algorithmic Trading">
  </a>
  <div class="card mb-4 box-shadow">
    <div class="card-body text-center">
      <h3 class="mb-3"><a class="link-fade" href="/advanced-algorithmic-trading-ebook/">Advanced Algorithmic Trading</a></h3>
      <p class="card-text medium-text mb-3">How to implement advanced trading strategies using time series analysis, machine learning and Bayesian statistics with R and Python.</p>
      <div class="d-flex justify-content-center align-items-center">
        <div class="btn-group">
          <a class="btn btn-padded btn-outline-primary btn-lg-cta" href="/advanced-algorithmic-trading-ebook/">Find Out More</a>
        </div>
      </div>
    </div>
  </div>
</div>
    </div>
  </div>
</section>

    

<footer>
  <div class="container container-full">
    <section class="mt-1.5 mb-1">
      <div class="row">
        <div class="col-12 col-sm-12 col-md-6 col-xl-3 mb-1.5">
          <ul class="footer-list">
            <li class="footer-list-title">QuantStart</li>
            <li class="footer-list-link"><a class="link-fade" href="/about/">About</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/articles/">Articles</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/sitemap/">Sitemap</a></li>
          </ul>
        </div>

        <div class="col-12 col-sm-12 col-md-6 col-xl-3 mb-1.5">
          <ul class="footer-list">
            <li class="footer-list-title">Products</li>
            
            <li class="footer-list-link"><a class="link-fade" href="/qsalpha/">QSAlpha</a></li>
            
            
            <li class="footer-list-link"><a class="link-fade" href="/quantcademy/">Quantcademy</a></li>
            
            <li class="footer-list-link"><a class="link-fade" href="/qstrader/">QSTrader</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/successful-algorithmic-trading-ebook/">Successful Algorithmic Trading</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/advanced-algorithmic-trading-ebook/">Advanced Algorithmic Trading</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/cpp-for-quantitative-finance-ebook/">C++ For Quantitative Finance</a></li>
          </ul>
        </div>

        <div class="col-12 col-sm-12 col-md-6 col-xl-3 mb-1.5">
          <ul class="footer-list">
            <li class="footer-list-title">Legal</li>
            <li class="footer-list-link"><a class="link-fade" href="/privacy-policy/">Privacy Policy</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/terms-and-conditions/">Terms &amp; Conditions</a></li>
          </ul>
        </div>

        <div class="col-12 col-sm-12 col-md-6 col-xl-3 mb-1.5">
          <ul class="footer-list">
            <li class="footer-list-title">Social</li>
            <li class="footer-list-link"><a class="link-fade" href="https://twitter.com/quantstart">Twitter</a></li>
            <li class="footer-list-link"><a class="link-fade" href="https://www.youtube.com/channel/UCmVnnZ6Y2TrJtY1eQJN6kWA">YouTube</a></li>
          </ul>
        </div>
      </div>
    </section>

    <div class="row mb-1.5 mt-5">
      <div class="col-12 col-md-9 col-lg-8 col-xl-6">
        <div class="footer-copyright">
          <p>©2012-2023 QuarkGluon Ltd. All rights reserved.</p>
        </div>
      </div>
    </div>
  </div>
</footer>

    
<script src="/static/js/jquery-3.2.1.min.js"></script>
<script src="/static/js/prism.js.min"></script>
<script src="/static/js/bootstrap.min.js"></script>
<script src="/static/js/nav.js"></script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-5383959-5']);
  _gaq.push(['_trackPageview']);

  (function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


    
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="/static/js/highcharts/highcharts.js"></script>
<script type="text/javascript">
  num_colours = 10;
</script>
<script src="/static/js/statistics.js"></script>


  </body>
</html>
