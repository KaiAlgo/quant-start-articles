
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="google-site-verification" content="wl3-8ed1QZjI0iYZMv10zoZWYElkMObTfwLlWIj9cpA" />
    <meta name="description" content="Autoregressive Integrated Moving Average ARIMA(p, d, q) Models for Time Series Analysis">

    <link rel="icon" href="/static/images/favicon.png">

    <title>Autoregressive Integrated Moving Average ARIMA(p, d, q) Models for Time Series Analysis | QuantStart</title>
    
    
<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900&display=swap" rel="stylesheet"> 
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900&display=swap" rel="stylesheet"> 
<link href="/static/css/bootstrap.min.css" rel="stylesheet">
<link href="/static/css/prism.css" rel="stylesheet">
<link href="/static/css/qs.css?v=10" rel="stylesheet">
    
  </head>

  <body>
    <header class="header covered-header" style="background-image: linear-gradient(rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.8)), url(https://quantstartmedia.s3.amazonaws.com/images/article-images/article-backgrounds/default-bg.jpg);">
  
<nav class="nav">
  <div class="container nav-container">
    <div class="nav-row row d-flex justify-content-between align-items-center">
      <div class="col-2">
        <ul class="nav-items justify-content-end small-capitals align-items-center">
          <li class="nav-item">
            <a class="link-fade" href="/">QuantStart</a>
          </li>
        </ul>
      </div>
      <div class="col-auto col-logo">
        <ul id="top-nav-menu" class="nav-items justify-content-end align-items-center">
          
          <li class="nav-item">
            <a class="link-fade" href="/qsalpha/">QSAlpha</a>
          </li>
          
          
          <li class="nav-item">
            <a class="link-fade" href="/quantcademy/">Quantcademy</a>
          </li>
          
          <li id="menu-link-ebooks" class="nav-item">
            <a class="link-fade" href="#">Books</a>
            <div id="menu-pane-ebooks" class="nav-items menu-dropdown-pane">
              <div class="nav-item">
                <a class="link-fade d-block ml-3 mr-3 my-3 mt-4" href="/successful-algorithmic-trading-ebook/">Successful Algorithmic Trading</a>
              </div>
              <div class="nav-item">
                <a class="link-fade d-block ml-3 mr-3 my-3 mt-4" href="/advanced-algorithmic-trading-ebook/">Advanced Algorithmic Trading</a>
              </div>
              <div class="nav-item">
                <a class="link-fade d-block ml-3 mr-3 my-3 mt-4" href="/cpp-for-quantitative-finance-ebook/">C++ For Quantitative Finance</a>
              </div>
            </div>
          </li>
          <li class="nav-item">
            <a class="link-fade" href="/qstrader/">QSTrader</a>
          </li>
          <li class="nav-item">
            <a class="link-fade" href="/articles/">Articles</a>
          </li>
          
          <li class="nav-item">
            <a class="link-fade" href="/members/login/">Login</a>
          </li>
          
        </ul>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>
    </div>
  </div>
</nav>

<nav id="mobile-nav" class="mobile-nav text-left">
  <div class="container">
    <ul class="mt-4 ml-3 mobile-nav-menu">
      <li class="nav-item">
        <a class="link-fade d-block" href="/">QuantStart</a>
      </li>

      
      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/qsalpha/">QSAlpha</a>
      </li>
      

      
      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/quantcademy/">Quantcademy</a>
      </li>
      

      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="#">Books</a>
      </li>
      <li class="nav-item sub-item">
        <a class="link-fade d-block ml-3" href="/successful-algorithmic-trading-ebook/">Successful Algorithmic Trading</a>
      </li>
      <li class="nav-item sub-item">
        <a class="link-fade d-block ml-3" href="/advanced-algorithmic-trading-ebook/">Advanced Algorithmic Trading</a>
      </li>
      <li class="nav-item sub-item">
        <a class="link-fade d-block ml-3" href="/cpp-for-quantitative-finance-ebook/">C++ For Quantitative Finance</a>
      </li>

      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/qstrader/">QSTrader</a>
      </li>

      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/articles/">Articles</a>
      </li>

      
      <li class="nav-item">
        <a class="link-fade d-block pt-3" href="/members/login/">Login</a>
      </li>
      
    </ul>
    <button class="nav-toggle mobile-nav-close">
      <svg id="mobile-nav-close-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M19.77,5.63,13.41,12l6.36,6.37a1,1,0,0,1-1.41,1.41L12,13.41,5.63,19.77a1,1,0,0,1-1.44-1.39l0,0L10.58,12,4.21,5.63a1,1,0,0,1,0-1.42,1,1,0,0,1,1.41,0l0,0L12,10.58l6.37-6.37a1,1,0,0,1,1.41,0A1,1,0,0,1,19.77,5.63Z"></path>
      </svg>
    </button>
  </div>
</nav>

  <div class="container hero-container">
    <section class="mt-5 mb-4">
      <div class="row justify-content-center">
        <div class="col-12 text-center">
          <p class="hero">Autoregressive Integrated Moving Average ARIMA(p, d, q) Models for Time Series Analysis</p>
          <p class="hero subhero">Autoregressive Integrated Moving Average ARIMA(p, d, q) Models for Time Series Analysis</p>
        </div>
      </div>
    </section>
  </div>
</header>
    
<section class="container content-container">
  <div class="row">
    <div class="col-md-8 order-md-2">
      <section class="content article-content">
        
        
        <p>In the previous set of articles (Parts <a href="https://www.quantstart.com/articles/Autoregressive-Moving-Average-ARMA-p-q-Models-for-Time-Series-Analysis-Part-1">1</a>, <a href="https://www.quantstart.com/articles/Autoregressive-Moving-Average-ARMA-p-q-Models-for-Time-Series-Analysis-Part-2">2</a> and <a href="https://www.quantstart.com/articles/Autoregressive-Moving-Average-ARMA-p-q-Models-for-Time-Series-Analysis-Part-3">3</a>) we went into significant detail about the AR(p), MA(q) and ARMA(p,q) linear time series models. We used these models to generate simulated data sets, fitted models to recover parameters and then applied these models to financial equities data.</p>

<p>In this article we are going to discuss an extension of the ARMA model, namely the Autoregressive Integrated Moving Average model, or ARIMA(p,d,q) model. We will see that it is necessary to consider the ARIMA model when we have non-stationary series. Such series occur in the presence of stochastic trends.</p> 

<h2>Quick Recap and Next Steps</h2>

<p>To date we have considered the following models (the links will take you to the appropriate articles):</p>

<ul>
  <li><a href="https://www.quantstart.com/articles/White-Noise-and-Random-Walks-in-Time-Series-Analysis">Discrete White Noise</a></li>
  <li><a href="https://www.quantstart.com/articles/White-Noise-and-Random-Walks-in-Time-Series-Analysis">Random Walk</a></li>
  <li><a href="https://www.quantstart.com/articles/Autoregressive-Moving-Average-ARMA-p-q-Models-for-Time-Series-Analysis-Part-1">Autoregressive Model of order p, AR(p)</a></li>
  <li><a href="https://www.quantstart.com/articles/Autoregressive-Moving-Average-ARMA-p-q-Models-for-Time-Series-Analysis-Part-2">Moving Average Model of order q, MA(q)</a></li>
  <li><a href="https://www.quantstart.com/articles/Autoregressive-Moving-Average-ARMA-p-q-Models-for-Time-Series-Analysis-Part-3">Autoregressive Moving Average Model of order p,q, ARMA(p,q)</a></li>
</ul>

<p>We have steadily built up our understanding of time series with concepts such as serial correlation, stationarity, linearity, residuals, correlograms, simulating, fitting, seasonality, conditional heteroscedasticity and hypothesis testing.</p>

<p>As of yet we have not carried out any prediction or forecasting from our models and so have not had any mechanism for producing a trading system or equity curve.</p>

<p>Once we have studied ARIMA (in this article), ARCH and GARCH (in the next articles), we will be in a position to build a basic long-term trading strategy based on prediction of stock market index returns.</p>

<p>Despite the fact that I have gone into a lot of detail about models which we know will ultimately not have great performance (AR, MA, ARMA), we are now well-versed in the process of time series modeling.</p>

<p>This means that when we come to study more recent models (and even those currently in the research literature), we will have a significant knowledge base on which to draw, in order to effectively evaluate these models, instead of treating them as a "turn key" prescription or "black box".</p>

<p>More importantly, it will provide us with the confidence to extend and modify them on our own and <em>understand what we are doing when we do it!</em></p>

<p>I'd like to thank you for being patient so far, as it might seem that these articles are far away from the "real action" of actual trading. However, true quantitative trading research is careful, measured and takes significant time to get right. There is no quick fix or "get rich scheme" in quant trading.</p>

<p>We're very nearly ready to consider our first trading model, which will be a mixture of ARIMA and GARCH, so it is imperative that we spend some time understanding the ARIMA model well!</p>

<p>Once we have built our first trading model, we are going to consider more advanced models such as long-memory processes, state-space models (i.e. the Kalman Filter) and Vector Autoregressive (VAR) models, which will lead us to other, more sophisticated, trading strategies.</p>

<h2>Autoregressive Integrated Moving Average (ARIMA) Models of order p, d, q</h2>

<h3>Rationale</h3>

<p>ARIMA models are used because they can reduce a non-stationary series to a stationary series using a sequence of <em>differencing</em> steps.</p>

<p>We can recall from the <a href="https://www.quantstart.com/articles/White-Noise-and-Random-Walks-in-Time-Series-Analysis">article on white noise and random walks</a> that if we apply the difference operator to a random walk series $\{x_t \}$ (a non-stationary series) we are left with white noise $\{w_t \}$ (a stationary series):</p>

\begin{eqnarray}
\nabla x_t = x_t - x_{t-1} = w_t
\end{eqnarray}

<p>ARIMA essentially performs this function, but does so repeatedly, $d$ times, in order to reduce a non-stationary series to a stationary one.</p>

<p>In order to handle other forms of non-stationarity beyond stochastic trends additional models can be used.</p>

<p>Seasonality effects (such as those that occur in commodity prices) can be tackled with the Seasonal ARIMA model (SARIMA), however we won't be discussing SARIMA much in this series.</p>

<p>Conditional heteroscedastic effects (as with volatility clustering in equities indexes) can be tackled with ARCH/GARCH.</p>

<p>In this article we will be considering non-stationary series with stochastic trends and fit ARIMA models to these series. We will also finally produce forecasts for our financial series.</p>

<h3>Definitions</h3>

<p>Prior to defining ARIMA processes we need to discuss the concept of an <strong>integrated</strong> series:</p>

<div class="bs-callout bs-callout-info">
<h4>Integrated Series of order $d$</h4>
<p>A time series $\{ x_t \}$ is <em>integrated of order $d$</em>, $I(d)$, if:</p>

\begin{eqnarray}
\nabla^d x_t = w_t
\end{eqnarray}

<p>That is, if we difference the series $d$ times we receive a discrete white noise series.</p>

<p>Alternatively, using the <a href="https://www.quantstart.com/articles/White-Noise-and-Random-Walks-in-Time-Series-Analysis">Backward Shift Operator</a> ${\bf B}$ an equivalent condition is:</p>

\begin{eqnarray}
(1-{\bf B}^d) x_t = w_t
\end{eqnarray}
</div>

<p>Now that we have defined an integrated series we can define the ARIMA process itself:</p>

<div class="bs-callout bs-callout-info">
<h4>Autoregressive Integrated Moving Average Model of order p, d, q</h4>
<p>A time series $\{x_t \}$ is an <em>autoregressive integrated moving average model of order p, d, q</em>, <strong>ARIMA(p,d,q)</strong>, if $\nabla^d x_t$ is an autoregressive moving average of order p,q, ARMA(p,q).</p>

<p>That is, if the series $\{x_t \}$ is differenced $d$ times, and it then follows an ARMA(p,q) process, then it is an ARIMA(p,d,q) series.</p>

<p>If we use the polynomial notation from <a href="https://www.quantstart.com/articles/Autoregressive-Moving-Average-ARMA-p-q-Models-for-Time-Series-Analysis-Part-1">Part 1</a> and <a href="https://www.quantstart.com/articles/Autoregressive-Moving-Average-ARMA-p-q-Models-for-Time-Series-Analysis-Part-2">Part 2</a> of the ARMA series, then an ARIMA(p,d,q) process can be written in terms of the <a href="https://www.quantstart.com/articles/White-Noise-and-Random-Walks-in-Time-Series-Analysis">Backward Shift Operator</a>, ${\bf B}$:</p>

\begin{eqnarray}
\theta_p({\bf B})(1-{\bf B})^d x_t = \phi_q ({\bf B}) w_t
\end{eqnarray}

<p>Where $w_t$ is a discrete white noise series.</p>
</div>

<p>There are some points to note about these definitions.</p>

<p>Since the random walk is given by $x_t = x_{t-1} + w_t$ it can be seen that $I(1)$ is another representation, since $\nabla^1 x_t = w_t$.</p>

<p>If we suspect a non-linear trend then we might be able to use repeated differencing (i.e. $d &gt; 1$) to reduce a series to stationary white noise.</p>

<p>In R we can use the <code>diff</code> command with additional parameters, e.g. <code>diff(x, d=3)</code> to carry out repeated differences.</p>

<h3>Simulation, Correlogram and Model Fitting</h3>

<p>Since we have already made use of the <code>arima.sim</code> command to simulate an ARMA(p,q) process, the following procedure will be similar to that carried out in <a href="https://www.quantstart.com/articles/Autoregressive-Moving-Average-ARMA-p-q-Models-for-Time-Series-Analysis-Part-3">Part 3</a> of the ARMA series.</p>

<p>The major difference is that we will now set $d=1$, that is, we will produce a non-stationary time series with a stochastic trending component.</p>

<p>As before we will fit an ARIMA model to our simulated data, attempt to recover the parameters, create confidence intervals for these parameters, produce a correlogram of the residuals of the fitted model and finally carry out a Ljung-Box test to establish whether we have a good fit.</p>

<p>We are going to simulate an ARIMA(1,1,1) model, with the autoregressive coefficient $\alpha=0.6$ and the moving average coefficient $\beta=-0.5$. Here is the R code to simulate and plot such a series:</p>

<pre>
<code class="language-r">> set.seed(2)
> x <- arima.sim(list(order = c(1,1,1), ar = 0.6, ma=-0.5), n = 1000)
> plot(x)</code>
</pre>

<p style="text-align:center">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-tsa-arimapdq-111-plot.png" width="100%" />
  <strong>Plot of simulated ARIMA(1,1,1) model with $\alpha=0.6$ and $\beta=-0.5$</strong>
</p>

<p>Now that we have our simulated series we are going to try and fit an ARIMA(1,1,1) model to it. Since we know the order we will simply specify it in the fit:</p>

<pre>
<code class="language-r">> x.arima <- arima(x, order=c(1, 1, 1))</code>
</pre>

<pre>
<code class="language-none">Call:
arima(x = x, order = c(1, 1, 1))

Coefficients:
         ar1      ma1
      0.6470  -0.5165
s.e.  0.1065   0.1189

sigma^2 estimated as 1.027:  log likelihood = -1432.09,  aic = 2870.18</code>
</pre>

<p>The confidence intervals are calculated as:</p>

<pre>
<code class="language-r">> 0.6470 + c(-1.96, 1.96)*0.1065</code>
</pre>

<pre>
<code class="language-none">0.43826 0.85574</code>
</pre>

<pre>
<code class="language-r">> -0.5165 + c(-1.96, 1.96)*0.1189</code>
</pre>

<pre>
<code class="language-none">-0.749544 -0.283456</code>
</pre>

<p>Both parameter estimates fall within the confidence intervals and are close to the true parameter values of the simulated ARIMA series. Hence, we shouldn't be surprised to see the residuals looking like a realisation of discrete white noise:</p>

<pre>
<code class="language-r">> acf(resid(x.arima))</code>
</pre>

<p style="text-align:center">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-tsa-arimapdq-111-resid-cor.png" width="100%" />
  <strong>Correlogram of the residuals of the fitted ARIMA(1,1,1) model</strong>
</p>

<p>Finally, we can run a Ljung-Box test to provide statistical evidence of a good fit:</p>

<pre>
<code class="language-r">> Box.test(resid(x.arima), lag=20, type="Ljung-Box")</code>
</pre>

<pre>
<code class="language-none">  Box-Ljung test

data:  resid(x.arima)
X-squared = 19.0413, df = 20, p-value = 0.5191</code>
</pre>

<p>We can see that the p-value is significantly larger than 0.05 and as such we can state that there is strong evidence for discrete white noise being a good fit to the residuals. Hence, the ARIMA(1,1,1) model is a good fit, as expected.</p>

<h3>Financial Data and Prediction</h3>

<p>In this section we are going to fit ARIMA models to Amazon, Inc. (AMZN) and the S&amp;P500 US Equity Index (^GPSC, in Yahoo Finance). We will make use of the <a href="https://cran.r-project.org/web/packages/forecast/forecast.pdf">forecast</a> library, written by <a href="http://robjhyndman.com/">Rob J Hyndman</a>.</p>

<p>Let's go ahead and install the library in R:</p> 

<pre>
<code class="language-r">> install.packages("forecast")
> library(forecast)</code>
</pre>

<p>Now we can use <a href="http://www.quantmod.com/">quantmod</a> to download the daily price series of Amazon from the start of 2013. Since we will have already taken the first order differences of the series, the ARIMA fit carried out shortly will not require $d &gt; 0$ for the integrated component:</p>

<pre>
<code class="language-r">> require(quantmod)
> getSymbols("AMZN", from="2013-01-01")
> amzn = diff(log(Cl(AMZN)))</code>
</pre>

<p>As in <a href="https://www.quantstart.com/articles/Autoregressive-Moving-Average-ARMA-p-q-Models-for-Time-Series-Analysis-Part-3">Part 3</a> of the ARMA series, we are now going to loop through the combinations of $p$, $d$ and $q$, to find the optimal ARIMA(p,d,q) model. By "optimal" we mean the order combination that minimises the Akaike Information Criterion (AIC):</p>

<pre>
<code class="language-r">> azfinal.aic <- Inf
> azfinal.order <- c(0,0,0)
> for (p in 1:4) for (d in 0:1) for (q in 1:4) {
>   azcurrent.aic <- AIC(arima(amzn, order=c(p, d, q)))
>   if (azcurrent.aic < azfinal.aic) {
>     azfinal.aic <- azcurrent.aic
>     azfinal.order <- c(p, d, q)
>     azfinal.arima <- arima(amzn, order=azfinal.order)
>   }
> }</code>
</pre>

<p>We can see that an order of $p=4$, $d=0$, $q=4$ was selected. Notably $d=0$, as we have already taken first order differences above:</p>

<pre>
<code class="language-r">> azfinal.order</code>
</pre>

<pre>
<code class="language-none">4 0 4</code>
</pre>

<p>If we plot the correlogram of the residuals we can see if we have evidence for a discrete white noise series:</p>

<pre>
<code class="language-r">> acf(resid(azfinal.arima), na.action=na.omit)</code>
</pre>

<p style="text-align:center">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-tsa-arimapdq-amzn-resid-cor.png" width="100%" />
  <strong>Correlogram of residuals of ARIMA(4,0,4) model fitted to AMZN daily log returns</strong>
</p>

<p>There are two significant peaks, namely at $k=15$ and $k=21$, although we should expect to see statistically significant peaks simply due to sampling variation 5% of the time. Let's perform a Ljung-Box test (see <a href="https://www.quantstart.com/articles/Autoregressive-Moving-Average-ARMA-p-q-Models-for-Time-Series-Analysis-Part-3">previous article</a>) and see if we have evidence for a good fit:</p>

<pre>
<code class="language-r">> Box.test(resid(azfinal.arima), lag=20, type="Ljung-Box")</code>
</pre>

<pre>
<code class="language-none">    Box-Ljung test

data:  resid(azfinal.arima)
X-squared = 12.6337, df = 20, p-value = 0.8925</code>
</pre>

<p>As we can see the p-value is greater than 0.05 and so we have evidence for a good fit at the 95% level.</p>

<p>We can now use the <code>forecast</code> command from the <a href="https://cran.r-project.org/web/packages/forecast/forecast.pdf">forecast</a> library in order to predict 25 days ahead for the returns series of Amazon:</p>

<pre>
<code class="language-r">> plot(forecast(azfinal.arima, h=25))</code>
</pre>

<p style="text-align:center">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-tsa-arimapdq-amzn-forecast.png" width="100%" />
  <strong>25-day forecast of AMZN daily log returns</strong>
</p>

<p>We can see the point forecasts for the next 25 days with 95% (dark blue) and 99% (light blue) error bands. We will be using these forecasts in our first time series trading strategy when we come to combine ARIMA and GARCH.</p>

<p>Let's carry out the same procedure for the S&amp;P500. Firstly we obtain the data from quantmod and convert it to a daily log returns stream:</p>

<pre>
<code class="language-r">> getSymbols("^GSPC", from="2013-01-01")
> sp = diff(log(Cl(GSPC)))</code>
</pre>

<p>We fit an ARIMA model by looping over the values of p, d and q:</p>

<pre>
<code class="language-r">> spfinal.aic <- Inf
> spfinal.order <- c(0,0,0)
> for (p in 1:4) for (d in 0:1) for (q in 1:4) {
>   spcurrent.aic <- AIC(arima(sp, order=c(p, d, q)))
>   if (spcurrent.aic < spfinal.aic) {
>     spfinal.aic <- spcurrent.aic
>     spfinal.order <- c(p, d, q)
>     spfinal.arima <- arima(sp, order=spfinal.order)
>   }
> }</code>
</pre>

<p>The AIC tells us that the "best" model is the ARIMA(2,0,1) model. Notice once again that $d=0$, as we have already taken first order differences of the series:</p>

<pre>
<code class="language-r">> spfinal.order</code>
</pre>

<pre>
<code class="language-none">2 0 1</code>
</pre>

<p>We can plot the residuals of the fitted model to see if we have evidence of discrete white noise:</p>

<pre>
<code class="language-r">> acf(resid(spfinal.arima), na.action=na.omit)</code>
</pre>

<p style="text-align:center">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-tsa-arimapdq-sp500-resid-cor.png" width="100%" />
  <strong>Correlogram of residuals of ARIMA(2,0,1) model fitted to S&amp;P500 daily log returns</strong>
</p>

<p>The correlogram looks promising, so the next step is to run the Ljung-Box test and confirm that we have a good model fit:</p>

<pre>
<code class="language-r">> Box.test(resid(spfinal.arima), lag=20, type="Ljung-Box")</code>
</pre>

<pre>
<code class="language-none">    Box-Ljung test

data:  resid(spfinal.arima)
X-squared = 13.6037, df = 20, p-value = 0.85</code>
</pre>

<p>Since the p-value is greater than 0.05 we have evidence of a good model fit.</p>

<p>Why is it that in the <a href="https://www.quantstart.com/articles/Autoregressive-Moving-Average-ARMA-p-q-Models-for-Time-Series-Analysis-Part-3">previous article</a> our Ljung-Box test for the S&amp;P500 showed that the ARMA(3,3) was a <em>poor</em> fit for the daily log returns?</p>

<p>Notice that I deliberately truncated the S&amp;P500 data to start from 2013 onwards in this article, which conveniently excludes the volatile periods around 2007-2008. Hence we have excluded a large portion of the S&amp;P500 where we had excessive volatility clustering. This impacts the serial correlation of the series and hence has the effect of making the series seem "more stationary" than it has been in the past.</p>

<p>This is a <em>very important</em> point. When analysing time series we need to be extremely careful of conditionally heteroscedastic series, such as stock market indexes. In quantitative finance, trying to determine periods of differing volatility is often known as "regime detection". It is one of the harder tasks to achieve!</p>

<p>We'll discuss this point at length in the next article when we come to consider the ARCH and GARCH models.</p>

<p>Let's now plot a forecast for the next 25 days of the S&amp;P500 daily log returns:</p>

<pre>
<code class="language-r">> plot(forecast(spfinal.arima, h=25))</code>
</pre>

<p style="text-align:center">
  <img src="https://s3.amazonaws.com/quantstartmedia/images/qs-tsa-arimapdq-sp500-forecast.png" width="100%" />
  <strong>25-day forecast of S&amp;P500 daily log returns</strong>
</p>

<p>Now that we have the ability to fit and forecast models such as ARIMA, we're very close to being able to create strategy indicators for trading.</p>

<h2>Next Steps</h2>

<p>In the next article we are going to take a look at the Generalised Autoregressive Conditional Heteroscedasticity (GARCH) model and use it to explain more of the serial correlation in certain equities and equity index series.</p>

<p>Once we have discussed GARCH we will be in a position to combine it with the ARIMA model and create signal indicators and thus a basic quantitative trading strategy.</p>
        
        
        <script async data-uid="6296c27f4b" src="https://weathered-brook-5281.ck.page/6296c27f4b/index.js"></script>
      </section>
    </div>
    <div class="col-md-4 book-card order-md-1">
      
<div class="sidebar-advert-container">
  <a href="/qsalpha/?ref=art">
    <img class="card-img-top" src="/static/images/qsalpha-sidebar-advert-small.png" alt="QSAlpha">
  </a>
  <div class="card mb-4 box-shadow">
    <div class="card-body text-center">
      <h3 class="mb-3"><a class="link-fade" href="/qsalpha/?ref=art">QSAlpha</a></h3>
      <p class="card-text medium-text mb-3">Join the QSAlpha research platform that helps fill your strategy research pipeline, diversifies your portfolio and improves your risk-adjusted returns for increased profitability.</p>
      <div class="d-flex justify-content-center align-items-center">
        <div class="btn-group">
          <a class="btn btn-padded btn-outline-primary btn-lg-cta" href="/qsalpha/?ref=art">Find Out More</a>
        </div>
      </div>
    </div>
  </div>

  <a href="/quantcademy/?ref=art">
    <img class="card-img-top" src="/static/images/quantcademy-sidebar-advert-small.png" alt="Quantcademy">
  </a>
  <div class="card mb-4 box-shadow">
    <div class="card-body text-center">
      <h3 class="mb-3"><a class="link-fade" href="/quantcademy/?ref=art">The Quantcademy</a></h3>
      <p class="card-text medium-text mb-3">Join the Quantcademy membership portal that caters to the rapidly-growing retail quant trader community and learn how to increase your strategy profitability.</p>
      <div class="d-flex justify-content-center align-items-center">
        <div class="btn-group">
          <a class="btn btn-padded btn-outline-primary btn-lg-cta" href="/quantcademy/?ref=art">Find Out More</a>
        </div>
      </div>
    </div>
  </div>

  <a href="/successful-algorithmic-trading-ebook/">
    <img class="card-img-top" src="/static/images/sat-sidebar-advert-small.png" alt="Successful Algorithmic Trading">
  </a>
  <div class="card mb-4 box-shadow">
    <div class="card-body text-center">
      <h3 class="mb-3"><a class="link-fade" href="/successful-algorithmic-trading-ebook/">Successful Algorithmic Trading</a></h3>
      <p class="card-text medium-text mb-3">How to find new trading strategy ideas and objectively assess them for your portfolio using a Python-based backtesting engine.</p>
      <div class="d-flex justify-content-center align-items-center">
        <div class="btn-group">
          <a class="btn btn-padded btn-outline-primary btn-lg-cta" href="/successful-algorithmic-trading-ebook/">Find Out More</a>
        </div>
      </div>
    </div>
  </div>

  <a href="/advanced-algorithmic-trading-ebook/">
    <img class="card-img-top" src="/static/images/aat-sidebar-advert-small.png" alt="Advanced Algorithmic Trading">
  </a>
  <div class="card mb-4 box-shadow">
    <div class="card-body text-center">
      <h3 class="mb-3"><a class="link-fade" href="/advanced-algorithmic-trading-ebook/">Advanced Algorithmic Trading</a></h3>
      <p class="card-text medium-text mb-3">How to implement advanced trading strategies using time series analysis, machine learning and Bayesian statistics with R and Python.</p>
      <div class="d-flex justify-content-center align-items-center">
        <div class="btn-group">
          <a class="btn btn-padded btn-outline-primary btn-lg-cta" href="/advanced-algorithmic-trading-ebook/">Find Out More</a>
        </div>
      </div>
    </div>
  </div>
</div>
    </div>
  </div>
</section>

    

<footer>
  <div class="container container-full">
    <section class="mt-1.5 mb-1">
      <div class="row">
        <div class="col-12 col-sm-12 col-md-6 col-xl-3 mb-1.5">
          <ul class="footer-list">
            <li class="footer-list-title">QuantStart</li>
            <li class="footer-list-link"><a class="link-fade" href="/about/">About</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/articles/">Articles</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/sitemap/">Sitemap</a></li>
          </ul>
        </div>

        <div class="col-12 col-sm-12 col-md-6 col-xl-3 mb-1.5">
          <ul class="footer-list">
            <li class="footer-list-title">Products</li>
            
            <li class="footer-list-link"><a class="link-fade" href="/qsalpha/">QSAlpha</a></li>
            
            
            <li class="footer-list-link"><a class="link-fade" href="/quantcademy/">Quantcademy</a></li>
            
            <li class="footer-list-link"><a class="link-fade" href="/qstrader/">QSTrader</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/successful-algorithmic-trading-ebook/">Successful Algorithmic Trading</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/advanced-algorithmic-trading-ebook/">Advanced Algorithmic Trading</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/cpp-for-quantitative-finance-ebook/">C++ For Quantitative Finance</a></li>
          </ul>
        </div>

        <div class="col-12 col-sm-12 col-md-6 col-xl-3 mb-1.5">
          <ul class="footer-list">
            <li class="footer-list-title">Legal</li>
            <li class="footer-list-link"><a class="link-fade" href="/privacy-policy/">Privacy Policy</a></li>
            <li class="footer-list-link"><a class="link-fade" href="/terms-and-conditions/">Terms &amp; Conditions</a></li>
          </ul>
        </div>

        <div class="col-12 col-sm-12 col-md-6 col-xl-3 mb-1.5">
          <ul class="footer-list">
            <li class="footer-list-title">Social</li>
            <li class="footer-list-link"><a class="link-fade" href="https://twitter.com/quantstart">Twitter</a></li>
            <li class="footer-list-link"><a class="link-fade" href="https://www.youtube.com/channel/UCmVnnZ6Y2TrJtY1eQJN6kWA">YouTube</a></li>
          </ul>
        </div>
      </div>
    </section>

    <div class="row mb-1.5 mt-5">
      <div class="col-12 col-md-9 col-lg-8 col-xl-6">
        <div class="footer-copyright">
          <p>©2012-2023 QuarkGluon Ltd. All rights reserved.</p>
        </div>
      </div>
    </div>
  </div>
</footer>

    
<script src="/static/js/jquery-3.2.1.min.js"></script>
<script src="/static/js/prism.js.min"></script>
<script src="/static/js/bootstrap.min.js"></script>
<script src="/static/js/nav.js"></script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-5383959-5']);
  _gaq.push(['_trackPageview']);

  (function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


    
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="/static/js/highcharts/highcharts.js"></script>
<script type="text/javascript">
  num_colours = 10;
</script>
<script src="/static/js/statistics.js"></script>


  </body>
</html>
